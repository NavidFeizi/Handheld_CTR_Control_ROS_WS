# Define project name and version
project(CTRlib VERSION 1.0 LANGUAGES CXX)

# listing the CTR library source files into a variable
set(CTR_LIB_SOURCES
    src/CTR.cpp
    src/Observer.cpp
    src/ODESystem.cpp
    src/Segment.cpp
    src/Tube.cpp
    src/openIGTLink.cpp
)

# Create the CTR static library
add_library(CTRlib STATIC ${CTR_LIB_SOURCES})

# Include directories for the CTR library
target_include_directories(CTRlib
    PUBLIC
        $<BUILD_INTERFACE:${CMAKE_CURRENT_SOURCE_DIR}/include>
        $<INSTALL_INTERFACE:include>
)

# Link NLOPT and math libraries
target_link_libraries(CTRlib
    PRIVATE
        nlopt
        m
)

# Check for the OpenIGTLink libray. If found, print message, include dirs, and link libraries.
set(OpenIGTLink_DIR "/usr/local/lib/igtl/cmake/igtl-3.1/")
find_package(OpenIGTLink REQUIRED PATHS OpenIGTLink_DIR)

if( OpenIGTLink_FOUND )
   message(STATUS "OpenIGTLink has been found!")
   target_include_directories(CTRlib PUBLIC ${OpenIGTLink_USE_FILE})
   target_link_libraries(CTRlib PUBLIC OpenIGTLink)
elseif(NOT OpenIGTLink_FOUND)
    error(STATUS "OpenIGTLink has not been found!")
endif()